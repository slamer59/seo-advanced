// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model Post {
    id         Int                    @id @default(autoincrement())
    name       String?
    createdAt  DateTime               @default(now())
    updatedAt  DateTime               @updatedAt
    gscData    SearchConsoleData[]
    gscRequest SearchConsoleRequest[]
    gscKPIs    SearchConsoleKPIs[]
    url        Url?

    @@index([name])
}

model Url {
    id        Int      @id @default(autoincrement())
    url       String
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    post      Post     @relation(fields: [postId], references: [id])
    postId    Int      @unique
}

model SearchConsoleData {
    id          Int      @id @default(autoincrement())
    post        Post     @relation(fields: [postId], references: [id])
    postId      Int
    keyword     String
    clicks      Int
    impressions Int
    position    Float
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt

    @@map("gsc_data")
}

model SearchConsoleRequest {
    id        Int                 @id @default(autoincrement())
    post      Post                @relation(fields: [postId], references: [id])
    postId    Int
    kpis      SearchConsoleKPIs[]
    startDate DateTime
    endDate   DateTime
    createdAt DateTime            @default(now())
    updatedAt DateTime            @updatedAt

    @@map("gsc_request")
}

model SearchConsoleKPIs {
    id                     Int                   @id @default(autoincrement())
    post                   Post                  @relation(fields: [postId], references: [id])
    postId                 Int
    clicks                 Int
    impressions            Int
    position               Float
    ctr                    Float
    createdAt              DateTime              @default(now())
    updatedAt              DateTime              @updatedAt
    gsc_request            SearchConsoleRequest? @relation(fields: [searchConsoleRequestId], references: [id])
    searchConsoleRequestId Int?

    @@map("gsc_kpis")
}
